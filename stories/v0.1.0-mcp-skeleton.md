# Story: v0.1.0 MCP Skeleton (Zig 0.15 + mcp.zig)

> 建立最小可运行的跨链 MCP Server 骨架：Zig 工程化、mcp.zig 接入、工具注册入口与核心抽象框架。

## Goals
- 建立 Zig 0.15 工程与构建系统（build.zig / build.zig.zon）
- 接入 mcp.zig，提供最小 Server（ping / list tools 可用）
- 定义统一的链/协议/交易/钱包抽象（骨架，无业务逻辑，兼容 DeFi 及未来 Web3 服务）
- 准备工具注册入口与示例工具（ping, get_balance 占位）

## Acceptance Criteria

### build & skeleton
- [x] build.zig / build.zig.zon 可用，支持 `zig build run` 启动 MCP Server
- [x] mcp.zig 依赖接入，Server 能返回 tools 列表
- [x] 提供 `ping` 工具，返回固定文本

### core abstractions
- [x] `core/chain.zig` 定义 ChainAdapter trait（vtable + ChainId/ChainType/Address/Transaction）
- [x] `core/wallet.zig` 定义统一钱包接口（ed25519 / secp256k1 占位）
- [x] `core/transaction.zig` 定义统一交易结构（含 chain_specific union）
- [x] `tools/balance.zig` 占位实现，保证编译通过

### server wiring
- [x] `src/main.zig` 启动 MCP Server（stdio），注册工具入口
- [x] `src/server.zig` 封装 mcp.zig Server 启动流程
- [x] MCP 客户端可 listTools（至少看到 ping, get_balance 占位）

### documentation
- [x] ROADMAP.md 已有 v0.1.0 入口并标记 ⏳
- [x] 设计文档：docs/design/mcp-skeleton.md 描述架构与最小闭环
- [x] 更新 README 或新增说明指向 Story/设计文档（如必要）

### testing
- [x] `zig build run` 启动无错误（或 `zig build` 编译通过）

## Test Results

### Build Verification
```bash
$ zig build
# Compiles successfully with no errors
```

### MCP Protocol Verification
```bash
# Initialize request/response
{"jsonrpc":"2.0","id":1,"method":"initialize",...}
→ {"jsonrpc":"2.0","id":1,"result":{"protocolVersion":"2025-11-25","capabilities":{"tools":{"listChanged":true},"logging":{}},"serverInfo":{"name":"omniweb3-mcp","version":"0.1.0",...}}}

# tools/list request/response
{"jsonrpc":"2.0","id":2,"method":"tools/list","params":{}}
→ {"jsonrpc":"2.0","id":2,"result":{"tools":[{"name":"ping","description":"Health check - returns pong",...},{"name":"get_balance","description":"Get balance for a chain address (mock)",...}]}}

# tools/call ping
{"jsonrpc":"2.0","id":3,"method":"tools/call","params":{"name":"ping"}}
→ {"jsonrpc":"2.0","id":3,"result":{"content":[{"type":"text","text":"pong from omniweb3-mcp"}],"isError":false}}

# tools/call get_balance
{"jsonrpc":"2.0","id":4,"method":"tools/call","params":{"name":"get_balance","arguments":{"chain":"solana","address":"5xJZxx..."}}}
→ {"jsonrpc":"2.0","id":4,"result":{"content":[{"type":"text","text":"{\"chain\": \"solana\", \"address\": \"5xJZxx...\", \"balance\": \"0.0 (mock)\"}"}],"isError":false}}
```

## Completion Status
- Start date: 2026-01-23
- Completion date: 2026-01-23
- Status: ✅ Completed
