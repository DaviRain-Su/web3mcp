# Story: v0.2.0 Solana Basics

> 实现 Solana 链的基础 RPC 集成：余额查询、转账功能，支持 Native SOL。

## Goals
- 集成 Solana JSON-RPC 客户端（使用 solana-client-zig 依赖）
- 实现真实的 get_balance 工具（Native SOL）
- 实现 transfer 工具（Native SOL 转账）
- 支持 Ed25519 签名（使用 solana-sdk-zig 依赖）
- 配置管理（RPC endpoint）

## Acceptance Criteria

### Dependencies Integration
- [x] 添加 solana-client-zig 作为构建依赖
- [x] 添加 solana-sdk-zig 作为构建依赖
- [x] 修复 gzip 压缩响应解码问题
- [x] 更新 build.zig 配置模块导入

### Solana RPC Client (via solana-client-zig)
- [x] HTTP JSON-RPC 客户端
- [x] 支持 getBalance（native SOL lamports）
- [x] 支持 getLatestBlockhash
- [x] 支持 sendTransaction
- [x] gzip 响应自动解压
- [x] 可配置 RPC endpoint（mainnet/devnet/testnet）

### Ed25519 Signing (via solana-sdk-zig)
- [x] Keypair 生成和导入
- [x] 从 Base58 编码导入 keypair
- [x] 支持 Solana transaction 签名格式
- [x] TransactionBuilder 构建签名交易

### Tools Implementation
- [x] `tools/balance.zig` 实现 Solana 余额查询
  - 参数: chain, address, network
  - 返回: balance (lamports), balance (SOL)
- [x] `tools/transfer.zig` 实现 SOL 转账
  - 参数: secret_key, to_address, amount, network
  - 返回: signature, tx details

### Configuration
- [x] 支持 network 参数配置 RPC endpoint
- [x] devnet 作为默认网络
- [x] 支持从环境变量配置（SOLANA_KEYPAIR）

### Testing
- [x] get_balance 在 devnet 上验证
- [x] transfer 在 localhost 验证（使用本地 validator）
- [ ] 集成测试（deferred to future version）

## Technical Notes

### Solana RPC Endpoints
- Mainnet: `https://api.mainnet-beta.solana.com`
- Devnet: `https://api.devnet.solana.com`
- Testnet: `https://api.testnet.solana.com`

### Dependencies
- solana-client-zig: JSON-RPC client, transaction builder
- solana-sdk-zig: PublicKey, Keypair, Signature, AccountMeta

### gzip Decompression Fix
Solana RPC 服务器可能返回 gzip 压缩响应，即使请求头设置了 Accept-Encoding: identity。
解决方案：在 solana-client-zig 的 json_rpc.zig 中添加 gzip 自动解压。

## Completion Status
- Start date: 2026-01-23
- Completion date: 2026-01-23
- Status: ✅ Completed (core functionality)

## Notes
- SPL Token 余额查询可在后续版本添加
- 环境变量配置可在后续版本添加
- transfer 工具需要用户提供有余额的 devnet keypair 进行测试
